Using the same compact notation from [[Symplectic transformations]] we can introduce an operation on *observables*, which are (smooth) real valued functions on the phase space. Recall the [[symplectic matrix|symplectic product]], then the **poisson bracket** of $f$ and $g$ is defined as
$$
\{f,g\} := [\partial_z f, \partial_z g]_J = \partial_q f \partial_p g - \partial_p f \partial_q g
$$

Consider a transformation $Q = Q(q,p)$ $P = P(q,p)$, let's check how it affects the poisson bracket of two observables $\tilde f = f(z(Z), t)$
, recall
$$
\partial_Z \tilde f = (\partial_Zz)^t \partial_z f
$$
$$
\begin{aligned}
\{\tilde f, \tilde g\}_Z &= [\partial_Z \tilde f, \partial_Z \tilde g]_J \\
 &= [(\partial_Zz)^t \partial_z f, (\partial_Zz)^t \partial_z g]_J \\
 &= [\partial_z f, \partial_z g]_J
\end{aligned} 
$$
where the last equality is true iff $(\partial_Zz)^t$ is symplecitc.

Computing the poisson's brackets on the simple obserbables $q_i$ and $p_i$ one finds the **canonical commutation rules**:
$$
\begin{aligned}
\{q_i, q_j\} &= 0 \\
\{p_i, p_j\} &= 0 \\
\{q_i, p_j\} &= \delta_{ij}
\end{aligned}
$$
clearly if $Q(q,p,t)$ and $P(q,p,t)$ are canonical transformation, then the canoical commutation rules also holds for the new variables w.r.t. them, but for the invariance we have just proven, they also holds for the new variables w.r.t. the old ones. This is again a characterization of canonical transformations.

> [!example]
> Consider the Hamiltonian of the one dimensional armonic oscillator:
> $$
> H = \frac 12(q^2 + p^2)
> $$
> then one can verify that the transformation
> $$
> \begin{aligned}
> Q &= \arctan{\frac qp} \\ 
> P &= \frac 12(q^2 + p^2)
> \end{aligned}
> $$
> is canonical by
> $$
> \{Q, P\}_{q,p} = 1
> $$
> with these variables the equations of motion are trivial:
> $$
> \begin{aligned}
> P(t) &= P_0\\
> Q(t) &= Q_0 + t 
> \end{aligned}
> $$
> where $P_0  =\frac 12(q_0^2 + p_0^2)$ and $Q_0 = \arctan{\frac {q_0}{p_0}  }$.

# Jacobi identity

To prove it we will use the identity:
$$
\{f,g\} = [\partial_z f, \partial_z g]_J = \partial_z f \cdot J\partial_z g = -J\partial_z f \cdot \partial_z g = -L_{J\partial_z f} (g)
$$
where $L$ is the [[Lie derivative]]. We can rewrite the Jacobi identity as
$$
([L_{J\partial_zf}, L_{J\partial_zg}] + L_{J\partial_z \{f,g\}})h
$$
this expression contains only first derivatives of $h$. The same identity can be obtained for $f$ and $g$. Thus the Jacobi indentity depends only on first derivatives, but if we expand the definition, every term (12) is a linear combination of second derivatives of $f,g,h$. This means it must be zero. We get an equivalend identity:
$$
[L_{J\partial_zf}, L_{J\partial_zg}] = -L_{J\partial_z \{f,g\}}
$$
which in terms of lie commutator of vector fields is:
$$
[J \partial_z f, J\partial_z g] = - J \partial_Z \{f,g\}
$$
We will call the vector field generated by a smooth function $f$ by
$$
J \partial_z f
$$
as **Hamiltonian vector field** associated to $f$.