---
tags: review
aliases:
cssclass:
---
 
# Commutating flows 

Let $v$ and $w$ be two smooth vectors fields on $\mathbb{R}^n$. Using local charts these results can be extended to any smooth manifold $M$. Call $\Phi$ and $\Psi$ their associated flows:
$$
\begin{cases}
\frac{d}{dt} \Phi^t(x) = v (\Phi^t(x)) \\
\Phi^0(x) = x
\end{cases}

\qquad 
\begin{cases}
\frac{d}{dt} \Psi^t(x) = w (\Psi^t(x)) \\
\Psi^0(x) = x
\end{cases}
$$

> [!lemma]
> $$
> \Phi^t(\Psi^s(x)) - \Psi^s(\Phi^t(x)) = st[w,v] + O^3
> $$
> > [!proof]-
> > We can Taylor expand at $t=s=0$, using the definition of flow:
> > $$
> > \begin{aligned}
> > \Phi^t(x) &= x + tv(x) + \frac{t^2}2 \nabla v(x)\cdot v + o(t^3) \\
> > \Psi^s(x) &= x + sw(x) + \frac{s^2}2 \nabla w(x)\cdot w + o(s^3)
> > \end{aligned} 
> > $$
> > using these we can expand the terms in the commutator, obtaining:
> >  $$
> > \Phi^t(\Psi^t(x)) &= x + v(x)t + w(x)s +  \nabla v(x)\cdot w st + O^3
> > $$
> > from which the claim follows. $\square$

We can now state and prove the following theorem:

> [!theorem]
> The flows $\Phi^t$ and $\Psi^s$ commute, that is
> $$
> \Phi^t(\Psi^s(x)) = \Psi^s(\Phi^t(x))
> $$
> for all $x, t,s$ iff their vector fields [[Lie derivative|commute]] $[v,w] = 0$.
> > [!proof]-
> > If they commute, then by the previous lemma it must be $[v,w]=0$. Suppose now $[v,w]=0$, then by the previous lemma  
> > $$
> > \Vert\Phi^t(\Psi^s(x)) - \Psi^s(\Phi^t(x))\Vert = O^3
> > $$
> > We will write the difference $\Phi^t(\Psi^s(x)) = \Psi^s(\Phi^t(x))$ as a sum of $N^2$ terms, all of which are $o(N^{-3})$, so their difference is $O(N^{-1})$ and goes to zero. Let $s,t > 0$, we define $\delta s = s/N$ and $\delta t = t/N$. We can find a sequence of paths $N^2$ paths such that they differ only for a swith $\delta s$ $\delta t$., which is by the lemma $O(N^{-3})$. Given a path $\gamma$, we can write as a sequence
> > $$
> > T_\gamma(x) = \Psi^{\delta s} \circ \Phi^{\delta t} \circ \dots
> > $$ 
> > If two paths differs only on a square, then
> > $$
> > T_{\gamma}(x) = T^+ \circ \Phi^{\delta t} \circ \Psi^{\delta s} \circ T^-
> > $$
> > $$
> > T_{\gamma'}(x) = T^+ \circ \Psi^{\delta s} \circ \Phi^{\delta t} \circ T^-
> > $$
> > then
> > $$
> > \Vert\Phi^t(\Psi^s(x)) - \Psi^s(\Phi^t(x))\Vert \leq \sum_{k=0}^{N^2-1} \Vert T_{\gamma_{k+1}}(x) - T_{\gamma_k}(x)\Vert = O(N^{-1}) \xrightarrow{N\to\infty} 0
> > $$
> > since 
> > $$
> > \Vert \Vert T_{\gamma'}(x) - T_{\gamma}(x) \Vert \leq c \Vert \Phi^{\delta t} \circ \Psi^{\delta s}(y) \Vert
> > $$
> > where $c$ is the Lipshitz constant of $T^+$.

# Symplecitc flows

> [!theorem] 
> Let $z \in \mathbb{R}^{2n}$ and $\Psi^t$ a [[Flow of an ODE|flow]] generated by the vector field $u$. Then $\partial_z \Psi^t$ is [[symplectic matrix|symplectic]] *iff* there exists (locally) a real valued function $K(z)$ such that:
> $$
> u = J\partial_z K
> $$
> that is, every hamiltonian flow is a symplectic flow and vice versa.
> > [!proof]-
> > Suppose $\partial_z \Psi^t$ is symplectic. Let's start by differentiating the flow equation:
> > $$
> > \frac{d}{dt} \partial_z \Psi_t(z) = \partial_z u(\Psi_t(z)) \partial_z \Psi_t(z)
> > $$
> > since $\partial_z \Psi_t$ is symplectic, it statisfies
> > $$
> > \partial_z \Psi_t^T J \partial_z \Psi_t = J
> > $$
> > if we take the time derivative and use the previous indentity we obtain
> > $$
> > \partial_z \Psi_t^T \partial_z u^T J \partial_z \Psi_t + \partial_z \Psi_t^T J \partial_z u \partial_z \Psi_t = 0
> > $$
> > and since the flow is invertible 
> > $$
> > J \partial_z u = - \partial_z u^T J
> > $$
> > evaluating this expression at $t=0$ and using $-J = J^T$
> > $$
> > J \partial_z u = (J\partial_z u)^T
> > $$
> > so that the matrix $J \partial_z u$ is symmetric, hence the form is closed, which implies that is locally exact, so that there exists a function $K(z)$ such that
> > $$
> > J u(z) = -\partial_z K(z) \implies u(z) = J \partial_z K(z)
> > $$
> > Assume now that $u = J \partial_z K$, then 
> > $$
> > \frac d{dt} \partial_z \Psi_t^T J \partial_z \Psi_t = 0
> > $$
> > by our previous computation and the fact that $u$ is exact implies that it's closed. Since at time $t=0$ $\partial_z \Psi_0 = Id$ is the indentity matrix, which is symplectic, $\partial_z \Psi_t$ is symplectic at all times. $\square$
> > 

Consider the transformations
$$
\begin{aligned}
Q &= Q(q_0,p_0,t) \\ 
P &= P(q_0,p_0,t) 
\end{aligned}
$$
where these functions solve the Hamilton equation of hamiltonian $H(p,q,t)$ with inital conditions $(q_0,p_0$). Since a flow is symplectic (canonical) iff it's hamiltonian, we know that this transformation is canonical, i.e.

 > [!quote]
 > Time evolution is a canonical transformation

Let's construct a generating function for this transformation. We can view the actions $S$ as a function of $q_0$, $q_1$ and $t$:
$$
S(q_0,q_1, t) = \int_0^t p\dot q - H(q,p,s)ds
$$
where $q(t)$ and $p(t)$ solve the hamilton equations. If we compute the first variation as usual, given $\delta q(0) = \delta q_0$ and $\delta q(t) = \delta q_1$:
$$
\begin{aligned}
\frac{d}{d \epsilon} S(q_0 + \epsilon \delta q_0, q_1 + \epsilon \delta q_1, t)\big|_{\epsilon=0} &= \int_0^t [\dot q \delta p+ p\delta\dot q -\partial_qH\delta q - \partial_p H \delta p ]\,ds
\end{aligned}
$$
since $q$ and $p$ solve Hamiltons equations
$$
= \int_0^t[ p \delta \dot q + \dot p \delta q ]ds = \int_0^t \frac{d}{ds} (p\delta q) ds = p_1 \delta q_1 - p_0 \delta q_0
$$
this implies (at fixed $t$)
$$
dS = p_1 dq_1 - p_0dq_0
$$
so it's indeed a [[Canonical transformations|canonical transformation]]. 
we can also compute the time derivative of $S$ along solutions:
$$
\frac{d}{dt}S(q_0, q(q_0,p_0,t),t) = p(t)\cdot\dot q(t) - H(q(t), p(t), t) = L
$$
which also shows that
$$
\partial_t S = H 
$$
