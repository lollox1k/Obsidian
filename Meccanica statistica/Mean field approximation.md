We have seen that solving [[Liouville equation]] or the [[BBGKY hierarchy]] is an hard task, the mean field approximation assumes that the interaction strenghts scales as $O(1/N)$, so that in the limit $N\to\infty$ particles should be indipendent, so that we expect a factorized solution. 

$$
\begin{cases}
\dot x_i = v_i \\
\dot v_i = \frac{1}{N} \sum_{j\neq i} F(x_i-x_j) = -\frac{1}{N} \sum_{j \neq i} \partial_x U(x_i-x_j)
\end{cases}
$$

The $\frac 1N$ term is important, otherwise the equation for $f_1$ would be trivial since the interaction term (the collision integral) is proportional to $N-1$:
$$
\left( \frac{\partial f_1}{\partial t}\right)_{\text{coll}} = (N-1) \int F(x_2-x_1) \cdot \partial_{v_1} f_2(x_1,x_2;\,v_1,v_2) d^3x_2d^3v_2
$$
if we formally suppose that $f_j^N \to f_j$, taking the limit on the equation for $f_j^N$ we find:
$$
\partial_t f_j + \sum_{i=1}^j v_i \cdot \partial_{x_i}f_j + \sum_{i=1}^j \int F(x_i - x_{i+1}) \cdot \partial_{v_i} f_{j+1} d^3x_{j+1} d^3v_{j+1} = 0
$$
the pair-interaction term of the $j$-particles goes to zero. The new thing is that now these equations admit factorized solutions, in particulare suppose that $f_2 = f_1(x_1,v_1)f_1(x_2,v_2)$, then we finde the **Vlasov equation**:
$$
\partial_t f + v\cdot \partial_x f + \left(\int F(x-y)f(y,w)\,dydw\right) \cdot \partial_v f = 0
$$

The name _mean field_ should be clear. By the [[Strong law of large numbers]] 
$$
\frac 1N \sum_{i=1}^N F(x-x_i) \xrightarrow{N\to\infty} \int F(x-y)f(y,w)\,dydw
$$

We can define various mean-field models with $O(1/N)$ interaction 
$$
\dot z_i = \frac 1N \sum_{j\neq i} G(z_i,z_j)
$$
the associated Liouville equations is
$$
\partial_t f^N + \frac 1N\sum_{i=1}^N \text{div}_{z_i}[f^N\sum_{j\neq i}G(z_i,z_j)] = 0
$$
the equation for $f_1$, in the limit $N\to\infty$ is
$$
\partial_t f + \text{div}_z(f \mathcal{K}[f]) = 0
$$
where
$$
\mathcal{K}[f] := \int G(z,w) f(w)dw
$$
---
# Solutions

Let $Z_t^f(z)$ be the [[Flow of an ODE|flow]] generated by $\mathcal{K}[f]$. In terms of [[Pushforward measure]], the solution is
$$
f_t = Z_t^f\# f_0
$$
since we don't know $f_t$, we don't know its flux $Z_t^f$, so this isn't a usefull solution, but it shows that the existence of $f_t$ depends on the flow, which in turn depends on $G$. We will assume that $f_0$ has compact support and that $G$ is Lipshitz and bounded.

To build a solution we will define a sequence, with a fixed points as the solution, in a very similar way of the proof [[Teorema di Picard–Lindelöf|Picard-Lindelof theorem]] for ODE.

> [!lemma]
> (Regularity of the vector field) Let $G$ be Lipshitz and bounded. Let $f_t$, $t \in [0,T]$, be a family of probability measures with every support bounded in a compact set $B$, and suppose this family is _weakly continuous_, that is $W_1(f_s,f_t) \to 0$ as $s \to t$. Then the vector field $\mathcal{K}[f]$ is bounded, lipshitz and continuous in $t \in [0,T]$.
> >[!proof]-
> > Boundness and lipshitz continuity of the field follow directly from the boundness and lipshitz of $G$ (and are the same values). Weakly continuity follows by rescaling $G$ by its lipshitz constnat, and using the characterization of the [[Wasserstein distance]] with $Lip_1$ functions. $\square$

A consequence of this lemma is that the flow $Z_f^t(z)$ is well defined at all times $t \in [0,T]$ and on all compacts. 

> [!lemma]
> (Flow dependence on the distribution) Let $f_t$ and $g_t$ two family of probability measures with $t \in [0,T]$ and the same assumption of the previous lemma. Then 
> $$
> |Z_t^f(z_1) - Z_t^g(z_2)| \leq e^{Lt}\left( |z_1-z_2| + L\int_0^t W_1(f_s,g_s)ds \right)
> $$
> where $L$ is the lipshitz constant of $G$.
> > [!proof]-
> > Write the definition of flow and integrate, subtract and take the absolute values to get the left side of the inequality. On the right we have a term
> > $$
> > \int_0^t ds |K[f_s](Z_s^f(z_1))-K[g_s](Z_s^g(z_2))|
> > $$
> > now add and subtract $K[f_s](Z_s^g(z_2))$, use the triangle inequality. We get two terms in the integral:
> > $$
> > |K[f_s](Z_s^f(z_1)) - K[f_s](Z_s^g(z_2))| \leq L|Z_s^f(z_1)-Z_s^g(z_2)|
> > $$
> > using Lipshitz continuity of the field.
> > The other term is, with $z = Z_s^g(z_2)$
> > $$
> > |K[f_s](z) - K[g_s](z)|
> > $$ 
> > to bound this we use the Wasserstein distance:
> > $$
> > K[f_s](z) - K[g_s](z) = \int G(z,u) f_s(du) - \int G(z,v) g_s(dv)
> > $$ 
> > given a joint distribution  $P(du,dv)$ with $f_s$ and $g_s$ as marginals
> > $$
> > = \int (G(z,u)-G(z,v))P(du,dv)
> > $$
> > using Lipshitz continuity of $G$ 
> > $$
> > \leq L \int |u-v|P(du,dv) 
> > $$
> > so this holds also for the $\inf$, which is the definition of the wasserstein metric
> > $$
> > |K[f_s](z) - K[g_s](z)| \leq W_1(f_s,g_s)
> > $$
> > Putting all terms togheter we find
> > $$
> > |Z_t^f(z_1) - Z_t^g(z_2)| \leq |z_1-z_2| + L\int_0^t W_1(f_s,g_s)ds + L\int_0^t |Z_s^f(z_1)-Z_s^f(z_2)|
> > $$
> > we can use [[Lemma di Gronwall|Gronwall's lemma]], and we are done. $\square$

> [!lemma]
> (Dependence of the solution on the flow measure)
> Let $f_0^{i}$ with $i = 1,2$ two starting measure with compact support $B_0$. Let $f_t^i$ be two measures, solution for $t \in [0,T]$ of the Liouville equation of the flows $Z_t^i$ generated by measures $g_t^i$, with $g_0^i = f_0^i$. Then the solutions measures $f_t^i$ have compact support $B$, which depends only on $T$, and are weakly continuous in $t$. Furthermore there exists constnat $C > 0$ and $\gamma \in (0,1)$ such that for $T$ small enough:
> $$
> \sup_{t \in [0,T]} W_1(f_t^1,f_t^2) \leq C W_1(f_0^1, f_0^2) + \gamma \sup_{t \in [0,T]} W_1(g_t^1, g_t^2)
> $$
> > [!proof]-
> > Since $|G| \leq M$ (is bounded) the support of solutions is bounded by $|Z_t(z)-z| \leq Mt$, hence can be bounded by $MT$ distance from $B_0$. 
> >Let $P_t(dz_1,dz_2)$ be a joint measure of $f_t^1$ and $f_t^2$, then
> >$$
> >\int |z_1-z_2| P_t(dz_1, dz_2) = \int |Z_t(z_1)^1-Z_t(z_2)^2| P_0(dz_1,dz_2)
> >$$
> >We now can use the previous lemma to bound the integral on the right side:
> >$$
> >\leq e^{Lt} \int |z_1-z_2| P_0(dz_1, dz_2) +Le^{Lt}\int_0^t W_1(g_s^1, g_s^2)\,ds
> >$$
> >Take the supremum onm both sides, with $T$ small enough $\gamma := Le^{Lt} < 1$. $\square$

We have all the tools to construct a solution. We say that a measure $f_t$ solves the vlasov equation if
$$
f_t = Z_t^f\#f_0
$$

The key idea is to see that a solution is a fixed point of the operator $M_t(f) = Z_t^f\#f_0$.

> [!theorem]
> Let $f_0$ be a probability measure, with compact support $B_0$. Then the mean field equation admits a unique weak solution for $t \in [0, T]$, and the solution is weakly continuous in the initial measure.
> > [!proof]-
> > The operator $M_t(f) = Z_t^f\#f_0$ for the previous lemma is a [[Teorema di Banach-Caccioppoli|contraction]], in the sense that
> > $$
> > \sup_{t \in [0,T]} W_1(M_t(g^1), M_t(g^2)) \leq \gamma \sup_{t \in [0,T]} W_1(g_t^1, g_t^2)
> > $$
> > with $\gamma < 1$. Then in a neighbourhood of $f_0$ exists $\{f_t\}_{t \in [0,T]}$ such that
> > $$
> > M_t(f_t) = f_t
> > $$
> > so that $f_t$ solves the Vlasov equation. Uniqueness follows from uniqueness of fixed poind, weak continuity follows from
> > $$
> > \sup_{t\in [0,T]} W_1(f_t, g_t) \leq \frac{C}{1-\gamma} W_1(f_0, g_0) \quad \square
> > $$
> 

---
# Dobrushin's convergence

> [!theorem]
> Let $z(0) = (z_1(0),\dots, z_N(0))$ be a set of particles in a compact $B_0$, initial datum for the ODE:
> $$
> \frac{d}{dt} z_i(t) = \frac 1N \sum_{j\neq i} G(z_i(t), z_j(t))
> $$
> then the associated _empirical measure_:
> $$
> \pi(z(t)) := \frac 1N \sum_{i=1}^N \delta_{z_i(t)}
> $$
> is a _weak solution_ of the Vlasov equation, so that $W_1(\pi(z^N(t), f_t) \to 0$ as $N\to \infty$ if $z_i \sim f_0$.
> > [!proof]-
> > Verify that $\pi(z(t))$ is a weak solution by substitution. It's generated vector field is
> > $$
> > K[\pi](z) = \int G(z,w) d\pi = \frac 1N\sum_{i=1}^N G(z, z_i(t))
> > $$
> > since $z_i(t)$ are the solution of this field, the flow $Z_t^\pi$ moves evert point as $z(t)$:
> > $$
> > Z_t^\pi \# \pi(z(0)) = \pi(z(t))
> > $$
> > the result follows from weak continuity of the solution on the initial measure. $\square$

